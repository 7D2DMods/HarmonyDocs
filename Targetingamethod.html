

<html>
	
<head>
	<title>Targeting a method</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="generator" content="HelpNDoc Personal Edition 5.2.0.265">
	<meta name="keywords" content="">
	
	
	
	<link type="text/css" rel="stylesheet" media="all" href="css/reset.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/base.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/hnd.css" />
	<!--[if lte IE 8]>
		<link type="text/css" rel="stylesheet" media="all" href="css/ielte8.css" />
	<![endif]-->
	<style type="text/css">
		#topic_header
		{
			background-color: #EFEFEF;
		}
	</style>
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/hnd.js"></script>
	<script type="text/javascript">
		$(document).ready(function()
		{
			if (top.frames.length == 0)
			{
				var sTopicUrl = top.location.href.substring(top.location.href.lastIndexOf("/") + 1, top.location.href.length);
				top.location.href = "index.htm?" + sTopicUrl;
			}
			else
			{
				var bTocSelected = false;
				(function waitForTOC()
				{
					if (top && top.FrameTOC && top.FrameTOC.SelectTocItem)
					{
						top.FrameTOC.SelectTocItem("Targetingamethod");
						bTocSelected = true;
					}
					if (!bTocSelected) setTimeout(function() { waitForTOC(); }, 300);
				})();
			}
		});
	</script>
	
	
</head>

<body>



	
		<div id="topic_header">
			<div id="topic_header_content">
				<h1 id="topic_header_text">Targeting a method</h1>
				
				
				<div id="topic_breadcrumb">
					<a href="HarmonyMods1.html">Harmony Mods</a> &rsaquo;&rsaquo; <a href="Harmony.html">Harmony</a> &rsaquo;&rsaquo; 
				</div>
				
			</div>
			
			<div id="topic_header_nav">
				
				
				<a href="Harmony.html"><img src="img/arrow_up.png" alt="Parent"/></a>
				
				
				
				<a href="DMTHarmonyFormat.html"><img src="img/arrow_left.png" alt="Previous"/></a>
				
				
				
				<a href="PrefixandPostfix.html"><img src="img/arrow_right.png" alt="Next"/></a>
				
				
			</div>
			
			<div class="clear"></div>
		</div>
	
	
	<div id="topic_content">
		
<p></p>
<p class="rvps2"><span class="rvts6">Harmony </span><span class="rvts16">targets </span><span class="rvts6">methods to find which ones you want to make changes to. This uses the HarmonyPatch mechanism. </span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">HarmonyPatch can be used in different combinations of formats to target your method.</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6">The following guides can be used:</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<div class="rvps2"><table width="100%" border="1" style="border-color: #000000; border-style: solid; border-spacing: 2px;">
<tr valign="top">
<td style="border-color: #000000; border-style: solid; padding: 1px; width: 316px; height: 17px;"><p class="rvps2"><span class="rvts26">References a Class</span></p>
</td>
<td style="border-color: #000000; border-style: solid; padding: 1px; width: 1057px; height: 17px;"><p class="rvps2"><span class="rvts26">[HarmonyPatch(</span><span class="rvts24">typeof</span><span class="rvts26">(NGuiWdwInGameHUD))] &nbsp; </span></p>
</td>
</tr>
<tr valign="top">
<td style="border-color: #000000; border-style: solid; padding: 1px; width: 316px;"><p class="rvps2"><span class="rvts26">References a Method</span></p>
</td>
<td style="border-color: #000000; border-style: solid; padding: 1px; width: 1057px;"><p class="rvps2"><span class="rvts26">[HarmonyPatch(</span><span class="rvts25">"SetTooltipText"</span><span class="rvts26">)]</span></p>
</td>
</tr>
<tr valign="top">
<td style="border-color: #000000; border-style: solid; padding: 1px; width: 316px;"><p class="rvps2"><span class="rvts26">References a parameter signature</span></p>
<p class="rvps2"><span class="rvts26"><br/></span></p>
</td>
<td style="border-color: #000000; border-style: solid; padding: 1px; width: 1057px;"><p class="rvps2"><span class="rvts26">[HarmonyPatch(</span><span class="rvts24">new</span><span class="rvts26"> Type[] { </span><span class="rvts24">typeof</span><span class="rvts26">(</span><span class="rvts24">string</span><span class="rvts26">), </span><span class="rvts24">typeof</span><span class="rvts26">(</span><span class="rvts24">string</span><span class="rvts26">[]), </span><span class="rvts24">typeof</span><span class="rvts26">(</span><span class="rvts24">string</span><span class="rvts26">), </span><span class="rvts24">typeof</span><span class="rvts26">(ToolTipEvent) })]</span></p>
</td>
</tr>
</table>
</div>
<p class="rvps2"><span class="rvts26"><br/></span></p>
<p class="rvps2"><span class="rvts26">If you are targeting a method that is not overloaded, then you would only need the first two: Class and Method. However, if the same method name exists with different parameters, you can add a reference to it. </span></p>
<p class="rvps2"><span class="rvts26"><br/></span></p>
<p class="rvps2"><span class="rvts26">In the above example, the parameter signature would be &nbsp;SetTooltipText( string myString, string[] myStringarray, string anotherString, ToolTipEvent justTheTip ). </span></p>
<p class="rvps2"><span class="rvts26"><br/></span></p>
<p class="rvps2"><span class="rvts26">Here are some examples from the ClearUI Mod:</span></p>
<p class="rvps2"><span class="rvts26"><br/></span></p>
<p class="rvps2"><span class="rvts26">Vanilla: </span></p>
<p class="rvps10"><span class="rvts43">protected</span><span class="rvts33">&nbsp;</span><span class="rvts43">override</span><span class="rvts33">&nbsp;</span><span class="rvts43">bool</span><span class="rvts33">&nbsp;</span><span class="rvts39">canShowOverlay</span><span class="rvts33">(</span><span class="rvts32">ItemActionData</span><span class="rvts33">&nbsp;</span><span class="rvts38">actionData</span><span class="rvts33">)</span></p>
<div class="rvps2"><table width="100%" border="1" style="border-color: #000000; border-style: solid; border-spacing: 2px;">
<tr valign="top">
<td style="border-color: #000000; border-style: solid; padding: 1px;"><p class="rvps2"><span class="rvts26"> &nbsp; &nbsp;[HarmonyPatch(</span><span class="rvts24">typeof</span><span class="rvts26">(ItemActionDynamic))]</span></p>
<p class="rvps2"><span class="rvts26"> &nbsp; &nbsp;[HarmonyPatch(</span><span class="rvts25">"canShowOverlay"</span><span class="rvts26">)]</span></p>
</td>
</tr>
</table>
</div>
<p class="rvps2"><span class="rvts26"><br/></span></p>
<p class="rvps2"><span class="rvts26">There is only one canShowOverlay in the ItemActionDynamic class, so we only need to specify the method name.</span></p>
<p class="rvps2"><span class="rvts26"><br/></span></p>
<p class="rvps2"><span class="rvts6">In the next example, the SetToolTipText in the NGuiWdwInGameHUD is a bit different. There are actually 5 methods with the same name, with different parameters:</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps10"><span class="rvts43">public</span><span class="rvts33">&nbsp;</span><span class="rvts43">void</span><span class="rvts33">&nbsp;</span><span class="rvts39">SetTooltipText</span><span class="rvts33">(</span><span class="rvts43">string</span><span class="rvts33">&nbsp;</span><span class="rvts38">_text</span><span class="rvts33">,&nbsp;</span><span class="rvts43">string</span><span class="rvts33">&nbsp;</span><span class="rvts38">_alertSound</span><span class="rvts33">)</span></p>
<p class="rvps10"><span class="rvts43">public</span><span class="rvts33">&nbsp;</span><span class="rvts43">void</span><span class="rvts33">&nbsp;</span><span class="rvts39">SetTooltipText</span><span class="rvts33">(</span><span class="rvts43">string</span><span class="rvts33">&nbsp;</span><span class="rvts38">_text</span><span class="rvts33">,&nbsp;</span><span class="rvts43">string</span><span class="rvts33">&nbsp;</span><span class="rvts38">_alertSound</span><span class="rvts33">,&nbsp;</span><span class="rvts32">ToolTipEvent</span><span class="rvts33">&nbsp;</span><span class="rvts38">handler</span><span class="rvts33">)</span></p>
<p class="rvps10"><span class="rvts43">public</span><span class="rvts33">&nbsp;</span><span class="rvts43">void</span><span class="rvts33">&nbsp;</span><span class="rvts39">SetTooltipText</span><span class="rvts33">(</span><span class="rvts43">string</span><span class="rvts33">&nbsp;</span><span class="rvts38">_text</span><span class="rvts33">,&nbsp;</span><span class="rvts43">string</span><span class="rvts33">&nbsp;</span><span class="rvts38">_arg</span><span class="rvts33">,&nbsp;</span><span class="rvts43">string</span><span class="rvts33">&nbsp;</span><span class="rvts38">_alertSound</span><span class="rvts33">)</span></p>
<p class="rvps10"><span class="rvts43">public</span><span class="rvts33">&nbsp;</span><span class="rvts43">void</span><span class="rvts33">&nbsp;</span><span class="rvts39">SetTooltipText</span><span class="rvts33">(</span><span class="rvts43">string</span><span class="rvts33">&nbsp;</span><span class="rvts38">_text</span><span class="rvts33">,&nbsp;</span><span class="rvts43">string</span><span class="rvts33">&nbsp;</span><span class="rvts38">_arg</span><span class="rvts33">,&nbsp;</span><span class="rvts43">string</span><span class="rvts33">&nbsp;</span><span class="rvts38">_alertSound</span><span class="rvts33">,&nbsp;</span><span class="rvts32">ToolTipEvent</span><span class="rvts33">&nbsp;</span><span class="rvts38">handler</span><span class="rvts33">)</span></p>
<p class="rvps10"><span class="rvts43">public</span><span class="rvts33">&nbsp;</span><span class="rvts43">void</span><span class="rvts33">&nbsp;</span><span class="rvts39">SetTooltipText</span><span class="rvts33">(</span><span class="rvts43">string</span><span class="rvts33">&nbsp;</span><span class="rvts38">_text</span><span class="rvts33">,&nbsp;</span><span class="rvts43">string</span><span class="rvts33">[]&nbsp;</span><span class="rvts38">_args</span><span class="rvts33">,&nbsp;</span><span class="rvts43">string</span><span class="rvts33">&nbsp;</span><span class="rvts38">_alertSound</span><span class="rvts33">,&nbsp;</span><span class="rvts32">ToolTipEvent</span><span class="rvts33">&nbsp;</span><span class="rvts38">eventHandler</span><span class="rvts33">)</span><br/><span class="rvts33"><br/></span></p>
<p class="rvps2"><span class="rvts6">We want to target the last one, so we have to define the parameter signature.</span></p>
<p class="rvps2"><span class="rvts33"><br/></span></p>
<p class="rvps2"><span class="rvts26">Vanilla:</span></p>
<p class="rvps10"><span class="rvts43">public</span><span class="rvts33">&nbsp;</span><span class="rvts43">void</span><span class="rvts33">&nbsp;</span><span class="rvts39">SetTooltipText</span><span class="rvts33">(</span><span class="rvts43">string</span><span class="rvts33">&nbsp;</span><span class="rvts38">_text</span><span class="rvts33">,&nbsp;</span><span class="rvts43">string</span><span class="rvts33">[]&nbsp;</span><span class="rvts38">_args</span><span class="rvts33">,&nbsp;</span><span class="rvts43">string</span><span class="rvts33">&nbsp;</span><span class="rvts38">_alertSound</span><span class="rvts33">,&nbsp;</span><span class="rvts32">ToolTipEvent</span><span class="rvts33">&nbsp;</span><span class="rvts38">eventHandler</span><span class="rvts33">)</span></p>
<div class="rvps2"><table width="100%" border="1" style="border-color: #000000; border-style: solid; border-spacing: 2px;">
<tr valign="top">
<td style="border-color: #000000; border-style: solid; padding: 1px;"><p class="rvps2"><span class="rvts26"> &nbsp; &nbsp;[HarmonyPatch(</span><span class="rvts24">typeof</span><span class="rvts26">(NGuiWdwInGameHUD))]</span></p>
<p class="rvps2"><span class="rvts26"> &nbsp; &nbsp;[HarmonyPatch(</span><span class="rvts25">"SetTooltipText"</span><span class="rvts26">)]</span></p>
<p class="rvps2"><span class="rvts26"> &nbsp; &nbsp;[HarmonyPatch(</span><span class="rvts24">new</span><span class="rvts26"> Type[] { </span><span class="rvts24">typeof</span><span class="rvts26">(</span><span class="rvts24">string</span><span class="rvts26">), </span><span class="rvts24">typeof</span><span class="rvts26">(</span><span class="rvts24">string</span><span class="rvts26">[]), </span><span class="rvts24">typeof</span><span class="rvts26">(</span><span class="rvts24">string</span><span class="rvts26">), </span><span class="rvts24">typeof</span><span class="rvts26">(ToolTipEvent) })]</span></p>
</td>
</tr>
</table>
</div>
<p class="rvps2"><span class="rvts33"><br/></span></p>
<p class="rvps2"><span class="rvts6">These definition must exist on top of the class that contains your Harmony calls, such as Prefix() and Postfix(). Those classes themselves do not need to define an interface to IHarmony, and they can be called whatever you want, as long as they are unique.</span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<div class="rvps2"><table width="100%" border="1" style="border-color: #000000; border-style: solid; border-spacing: 2px;">
<tr valign="top">
<td style="border-color: #000000; border-style: solid; padding: 1px;"><p class="rvps2"><span class="rvts26"> &nbsp; &nbsp;</span><span class="rvts30">// Remove the SetLabel Text calls</span></p>
<p class="rvps2"><span class="rvts26"> &nbsp; &nbsp;[HarmonyPatch(</span><span class="rvts24">typeof</span><span class="rvts26">(NGUIWindowManager))]</span></p>
<p class="rvps2"><span class="rvts26"> &nbsp; &nbsp;[HarmonyPatch(</span><span class="rvts25">"SetLabelText"</span><span class="rvts26">)]</span></p>
<p class="rvps2"><span class="rvts26"> &nbsp; &nbsp;[HarmonyPatch(</span><span class="rvts24">new</span><span class="rvts26"> Type[] { </span><span class="rvts24">typeof</span><span class="rvts26">(EnumNGUIWindow), </span><span class="rvts24">typeof</span><span class="rvts26">(</span><span class="rvts24">string</span><span class="rvts26">), </span><span class="rvts24">typeof</span><span class="rvts26">(</span><span class="rvts24">bool</span><span class="rvts26">) })]</span></p>
<p class="rvps2"><span class="rvts26"> &nbsp; &nbsp;</span><span class="rvts24">public</span><span class="rvts26"> </span><span class="rvts24">class</span><span class="rvts26"> </span><span class="rvts29">SphereII_ClearUI_NGUIWindowManager_SetLabelText</span></p>
<p class="rvps2"><span class="rvts26"> &nbsp; &nbsp;{</span></p>
<p class="rvps2"><span class="rvts26"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="rvts24">static</span><span class="rvts26"> </span><span class="rvts24">bool</span><span class="rvts26"> Prefix()</span></p>
<p class="rvps2"><span class="rvts26"> &nbsp; &nbsp; &nbsp; &nbsp;{</span></p>
<p class="rvps2"><span class="rvts26"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="rvts24">return</span><span class="rvts26"> </span><span class="rvts24">false</span><span class="rvts26">;</span></p>
<p class="rvps2"><span class="rvts26"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></p>
<p class="rvps2"><span class="rvts26"> &nbsp; &nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p class="rvps2"><span class="rvts6"><br/></span></p>
<p></p>
<p class="rvps5" style="clear: both;"><span class="rvts13">Created with the Personal Edition of HelpNDoc: </span><a class="rvts14" href="https://www.helpndoc.com/help-authoring-tool">Free help authoring tool</a></p>

	</div>
	
	
		<div id="topic_footer">

			<div id="topic_footer_content">
				Copyright &copy; 2019 by sphereii. All Rights Reserved.
			</div>
		</div>
	
	

	
</body>
	
</html>

